<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Empire War</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>

<div class="main">
    <div class="container">
        <div class="left initial run" data-count="1">
            <span class="l item"></span>
        </div>
        <div class="right initial run" data-count="1">
            <span class="r item"></span>
        </div>
        <div class="left initial" ></div>
        <div class="right initial" ></div>
    </div>
</div>

<script src="jquery.js"></script>
<script>
    $(document).ready(function () {
        var count = 1;
        var counts = [];
        var canMove = false;
        var clonedItems = 1;
        var itemId;
        var selectedArea;
        var initialTimer = setTimeout(function initial() {
            count += 1;
            $('.run').attr('data-count', count);
            initialTimer = setTimeout(initial, 1500);
        }, 1500);

        $('.run').children('span').mousedown(function (e) {
            canMove = true;
            clonedItems += 1;
            itemId = 'item'+clonedItems;
            let classNames = e.target.className;
            // let parentClass = e.target.parentNode.className.indexOf('left') !== -1 ? 'left' : 'right';
            // $('body').addClass(parentClass);
            $('<span/>', {
                class: classNames+' absolute',
                id: itemId
            }).appendTo('body');
            $('#' + itemId).css({top: e.pageY, left: e.pageX})
        });
        $(document).mouseup(function (e) {
            // console.log(e);
            // let checkingClass = e.target.className.indexOf('run');
            console.log(e);
            console.log(selectedArea);
            if (selectedArea){
                selectedArea.append($('#' + itemId));
                selectedArea.addClass('run');
                if (selectedArea.hasClass('run')){
                    selectedArea.attr('data-count', count);
                }
                $('#' + itemId).removeClass('absolute')
            }
            $('body').removeClass();
            canMove = false;
        });
        $(document).mousemove(function (e) {
            if(!canMove) return;
            $('#' + itemId).css({top: e.pageY, left: e.pageX})
        });
        $('.initial').mouseenter(function () {
            if(!canMove) return;
            selectedArea = $(this);
            console.log($(this));
        })
    })
</script>
</body>
</html>
